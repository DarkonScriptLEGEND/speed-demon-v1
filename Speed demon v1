local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()

-- Safe teleport positions
local lastSafePosition = Character:WaitForChild("HumanoidRootPart").Position

-- Create ScreenGui
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "SpeedDemonGUI"

-- Toggle Icon
local toggleButton = Instance.new("TextButton", gui)
toggleButton.Size = UDim2.new(0, 140, 0, 30)
toggleButton.Position = UDim2.new(0, 10, 0.5, -100)
toggleButton.BackgroundColor3 = Color3.new(0, 0, 0)
toggleButton.Text = "Speed Demon V1"
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.Draggable = true
toggleButton.Active = true
toggleButton.AutoButtonColor = true

-- Main Frame
local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 220, 0, 160)
frame.Position = UDim2.new(0, 160, 0.5, -100)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.Visible = true
frame.Active = true

-- Title
local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
title.Text = "Speed Demon V1"
title.TextColor3 = Color3.new(1, 1, 1)
title.TextScaled = true

-- Button: Speed Boost
local speedButton = Instance.new("TextButton", frame)
speedButton.Size = UDim2.new(1, -20, 0, 40)
speedButton.Position = UDim2.new(0, 10, 0, 40)
speedButton.Text = "Speed Boost"
speedButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
speedButton.TextColor3 = Color3.new(1, 1, 1)

-- Button: Ultimate Form
local ultimateButton = Instance.new("TextButton", frame)
ultimateButton.Size = UDim2.new(1, -20, 0, 40)
ultimateButton.Position = UDim2.new(0, 10, 0, 90)
ultimateButton.Text = "Ultimate Form"
ultimateButton.BackgroundColor3 = Color3.fromRGB(255, 106, 0)
ultimateButton.TextColor3 = Color3.new(1, 1, 1)

-- Button: Send Out Credits
local creditButton = Instance.new("TextButton", gui)
creditButton.Size = UDim2.new(0, 170, 0, 30)
creditButton.Position = UDim2.new(1, -180, 1, -40)
creditButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
creditButton.TextColor3 = Color3.new(1, 1, 1)
creditButton.Text = "Send Out Credits in Chat"
creditButton.TextScaled = true
creditButton.AnchorPoint = Vector2.new(0, 1)

-- Toggle Show/Hide
toggleButton.MouseButton1Click:Connect(function()
	frame.Visible = not frame.Visible
end)

-- Speed Boost Logic
local cooldown = false
speedButton.MouseButton1Click:Connect(function()
	if cooldown then return end
	cooldown = true

	local humanoid = Character:FindFirstChildOfClass("Humanoid")
	if humanoid then
		local originalSpeed = humanoid.WalkSpeed
		humanoid.WalkSpeed = originalSpeed + 27
		wait(2.5)
		humanoid.WalkSpeed = originalSpeed
	end
	wait(7)
	cooldown = false
end)

-- Teleport Sound
local function playTeleportEffect(pos)
	local hrp = Character:FindFirstChild("HumanoidRootPart")
	if not hrp then return end

	local sound = Instance.new("Sound", hrp)
	sound.SoundId = "rbxassetid://12222005"
	sound.Volume = 2
	sound:Play()
	game.Debris:AddItem(sound, 2)

	for i = 1, 10 do
		local part = Instance.new("Part")
		part.Anchored = true
		part.CanCollide = false
		part.Size = Vector3.new(0.5, 0.5, 0.5)
		part.Shape = Enum.PartType.Ball
		part.Material = Enum.Material.Neon
		part.Color = Color3.new(0, 0, 0)
		part.Position = pos + Vector3.new(math.random(-3, 3), math.random(-3, 3), math.random(-3, 3))
		part.Parent = workspace
		game.Debris:AddItem(part, 1)
	end
end

-- Ultimate Form Logic
local ultimateCooldown = false
local function activateUltimate()
	if ultimateCooldown then return end
	ultimateCooldown = true

	local hrp = Character:FindFirstChild("HumanoidRootPart")
	if not hrp then return end

	for i = 1, 25 do
		local offset = Vector3.new(math.random(-75,75), 0, math.random(-75,75))
		local targetPos = hrp.Position + offset
		local ray = Ray.new(targetPos + Vector3.new(0, 50, 0), Vector3.new(0, -100, 0))
		local hit, safePos = workspace:FindPartOnRay(ray)
		if hit then
			hrp.CFrame = CFrame.new(safePos + Vector3.new(0, 5, 0))
			playTeleportEffect(hrp.Position)
			wait(0.2)
		end
	end

	local humanoid = Character:FindFirstChildOfClass("Humanoid")
	if humanoid then
		local originalSpeed = humanoid.WalkSpeed
		humanoid.WalkSpeed = 46
		wait(5.5)
		humanoid.WalkSpeed = originalSpeed
	end
	wait(10)
	ultimateCooldown = false
end

-- Ultimate Button Click
ultimateButton.MouseButton1Click:Connect(activateUltimate)

-- Auto activate ultimate if enemy near
game:GetService("RunService").Heartbeat:Connect(function()
	if ultimateCooldown then return end
	local hrp = Character:FindFirstChild("HumanoidRootPart")
	if not hrp then return end

	for _, player in pairs(Players:GetPlayers()) do
		if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
			local dist = (player.Character.HumanoidRootPart.Position - hrp.Position).Magnitude
			if dist < 8.5 then
				activateUltimate()
				break
			end
		end
	end
end)

-- Credits Button Functionality
creditButton.MouseButton1Click:Connect(function()
	game.StarterGui:SetCore("ChatMakeSystemMessage", {
		Text = "Speed Demon V1 script made by Darkon",
		Color = Color3.new(1, 1, 1),
		Font = Enum.Font.SourceSansBold,
		FontSize = Enum.FontSize.Size24
	})
end)
